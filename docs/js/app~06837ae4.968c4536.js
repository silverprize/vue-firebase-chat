(function(e){function t(t){for(var r,a,i=t[0],u=t[1],s=t[2],d=0,f=[];d<i.length;d++)a=i[d],Object.prototype.hasOwnProperty.call(o,a)&&o[a]&&f.push(o[a][0]),o[a]=0;for(r in u)Object.prototype.hasOwnProperty.call(u,r)&&(e[r]=u[r]);l&&l(t);while(f.length)f.shift()();return c.push.apply(c,s||[]),n()}function n(){for(var e,t=0;t<c.length;t++){for(var n=c[t],r=!0,a=1;a<n.length;a++){var i=n[a];0!==o[i]&&(r=!1)}r&&(c.splice(t--,1),e=u(u.s=n[0]))}return e}var r={},a={"app~06837ae4":0},o={"app~06837ae4":0},c=[];function i(e){return u.p+"js/"+({"main~31ecd969":"main~31ecd969","vendors~chat-room~chat-room-list~987e6011":"vendors~chat-room~chat-room-list~987e6011","chat-room-list~21833f8f":"chat-room-list~21833f8f","vendors~chat-room~d939e436":"vendors~chat-room~d939e436","chat-room~21833f8f":"chat-room~21833f8f"}[e]||e)+"."+{"main~31ecd969":"faa1815a","vendors~chat-room~chat-room-list~987e6011":"5d94a9e8","chat-room-list~21833f8f":"c7b51227","vendors~chat-room~d939e436":"d5065859","chat-room~21833f8f":"cfacbdd3"}[e]+".js"}function u(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,u),n.l=!0,n.exports}u.e=function(e){var t=[],n={"main~31ecd969":1,"chat-room-list~21833f8f":1,"chat-room~21833f8f":1};a[e]?t.push(a[e]):0!==a[e]&&n[e]&&t.push(a[e]=new Promise((function(t,n){for(var r="css/"+({"main~31ecd969":"main~31ecd969","vendors~chat-room~chat-room-list~987e6011":"vendors~chat-room~chat-room-list~987e6011","chat-room-list~21833f8f":"chat-room-list~21833f8f","vendors~chat-room~d939e436":"vendors~chat-room~d939e436","chat-room~21833f8f":"chat-room~21833f8f"}[e]||e)+"."+{"main~31ecd969":"15b94d15","vendors~chat-room~chat-room-list~987e6011":"31d6cfe0","chat-room-list~21833f8f":"52a8c9d7","vendors~chat-room~d939e436":"31d6cfe0","chat-room~21833f8f":"6b0ced50"}[e]+".css",o=u.p+r,c=document.getElementsByTagName("link"),i=0;i<c.length;i++){var s=c[i],d=s.getAttribute("data-href")||s.getAttribute("href");if("stylesheet"===s.rel&&(d===r||d===o))return t()}var f=document.getElementsByTagName("style");for(i=0;i<f.length;i++){s=f[i],d=s.getAttribute("data-href");if(d===r||d===o)return t()}var l=document.createElement("link");l.rel="stylesheet",l.type="text/css",l.onload=t,l.onerror=function(t){var r=t&&t.target&&t.target.src||o,c=new Error("Loading CSS chunk "+e+" failed.\n("+r+")");c.code="CSS_CHUNK_LOAD_FAILED",c.request=r,delete a[e],l.parentNode.removeChild(l),n(c)},l.href=o;var p=document.getElementsByTagName("head")[0];p.appendChild(l)})).then((function(){a[e]=0})));var r=o[e];if(0!==r)if(r)t.push(r[2]);else{var c=new Promise((function(t,n){r=o[e]=[t,n]}));t.push(r[2]=c);var s,d=document.createElement("script");d.charset="utf-8",d.timeout=120,u.nc&&d.setAttribute("nonce",u.nc),d.src=i(e);var f=new Error;s=function(t){d.onerror=d.onload=null,clearTimeout(l);var n=o[e];if(0!==n){if(n){var r=t&&("load"===t.type?"missing":t.type),a=t&&t.target&&t.target.src;f.message="Loading chunk "+e+" failed.\n("+r+": "+a+")",f.name="ChunkLoadError",f.type=r,f.request=a,n[1](f)}o[e]=void 0}};var l=setTimeout((function(){s({type:"timeout",target:d})}),12e4);d.onerror=d.onload=s,document.head.appendChild(d)}return Promise.all(t)},u.m=e,u.c=r,u.d=function(e,t,n){u.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},u.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},u.t=function(e,t){if(1&t&&(e=u(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(u.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)u.d(n,r,function(t){return e[t]}.bind(null,r));return n},u.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return u.d(t,"a",t),t},u.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},u.p="/vue-firebase-chat/",u.oe=function(e){throw e};var s=window["webpackJsonp"]=window["webpackJsonp"]||[],d=s.push.bind(s);s.push=t,s=s.slice();for(var f=0;f<s.length;f++)t(s[f]);var l=d;c.push([0,"app~c5b24172","app~8a6c828a","app~7ffa8a2f","app~8b322766","app~1fb195ae","app~c1554789","app~d939e436","app~b58f7129","app~1c3a2c3f","app~d2305125"]),n()})({"0613":function(e,t,n){"use strict";var r,a,o,c=n("2b0e"),i=n("2f62"),u=n("ade3"),s=(n("4160"),n("159b"),n("5530")),d=(n("96cf"),n("1da1")),f="session.setProfile",l="session.setConnected",p="session.setSignedIn",m="session.clear",h=n("5089"),b=n("4037"),v=n("7bd1"),g=n("4f76"),O=n("c592"),j=n("5e44"),y=n("afbc"),I={state:function(){return{user:null,isConnecting:!1,isSignedIn:!1,unsubscribes:[]}},getters:(r={},Object(u["a"])(r,h["b"],(function(e){return e.isConnecting})),Object(u["a"])(r,h["c"],(function(e){return e.isSignedIn})),Object(u["a"])(r,h["d"],(function(e,t){return t[h["b"]]&&t[h["c"]]})),Object(u["a"])(r,h["a"],(function(e){return e.user})),r),mutations:(a={},Object(u["a"])(a,f,(function(e,t){e.user=t})),Object(u["a"])(a,l,(function(e,t){e.isConnecting=t})),Object(u["a"])(a,p,(function(e,t){e.isSignedIn=t})),Object(u["a"])(a,m,(function(e){e.unsubscribes.forEach((function(e){return e()})),e.user=null,e.isConnecting=!1,e.isSignedIn=!1,e.unsubscribes=[]})),a),actions:(o={},Object(u["a"])(o,b["a"],(function(e){return Object(d["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(v["c"])();case 2:if(n=t.sent,!n){t.next=8;break}return t.next=6,k(e);case 6:t.next=9;break;case 8:throw new Error("Unauthorized");case 9:return t.abrupt("return",n);case 10:case"end":return t.stop()}}),t)})))()})),Object(u["a"])(o,b["b"],(function(e,t){return Object(d["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,Object(v["h"])(t);case 2:return n.next=4,k(e);case 4:case"end":return n.stop()}}),n)})))()})),Object(u["a"])(o,b["c"],(function(e){return Object(d["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=e.commit,t.next=3,Object(v["i"])();case 3:n(m);case 4:case"end":return t.stop()}}),t)})))()})),o)};function k(e){var t=function(t){t&&e.commit(f,t),e.commit(p,null!=t)},n=function(t){e.getters[h["b"]]&&!t&&e.dispatch(O["b"],{dialogType:g["a"].MESSAGE,params:{message:"서버와 연결이 끊겼습니다.",closeText:""}}),e.commit(l,t)},r=function(t){e.dispatch(O["b"],{dialogType:g["a"].CONFIRM_INVITATION,params:Object(s["a"])(Object(s["a"])({},t),{},{handleOk:function(){Object(v["d"])(t.id),y["a"].push({name:j["a"].ChatRoom,params:{roomId:t.room.id}})}})})};e.commit(m),e.state.unsubscribes.push(Object(v["n"])(r),Object(v["j"])(t),Object(v["m"])(n))}var E,_,w,R=I,T=(n("c740"),n("d81d"),n("13d5"),n("a434"),n("b0c0"),n("d3b7"),n("3ca3"),n("ddb0"),n("2909")),A=n("c50a"),S="chat.setRooms",x="chat.setPeople",C="chat.setRoom",M="chat.clear",D="chat.addMessage",N="chat.addUser",P="chat.removeUser",L="chat.imageUploaded",U=n("26b2"),V=n("a47c"),G=v["b"].ContentType,B="RoomsKey",$="RoomKey",q={id:"",order:-1,name:"",countPeople:0},F={state:function(){return{rooms:[],people:[],messages:[],room:q,unsubscribes:{},imageMessageIndices:{}}},getters:(E={},Object(u["a"])(E,U["c"],(function(e){return e.rooms})),Object(u["a"])(E,U["d"],(function(e){return e.room})),Object(u["a"])(E,U["a"],(function(e){return e.messages})),Object(u["a"])(E,U["b"],(function(e){return e.people})),E),mutations:(_={},Object(u["a"])(_,S,(function(e,t){e.rooms=t})),Object(u["a"])(_,x,(function(e,t){e.people=t})),Object(u["a"])(_,C,(function(e,t){e.room=t})),Object(u["a"])(_,D,(function(e,t){t.contentType===v["b"].ContentType.Image&&(e.imageMessageIndices[t.id]=e.messages.length),e.messages.push(t)})),Object(u["a"])(_,N,(function(e,t){e.people.push(t)})),Object(u["a"])(_,P,(function(e,t){var n=e.people.findIndex((function(e){var n=e.id;return n===t.id}));e.people.splice(n,1)})),Object(u["a"])(_,L,(function(e,t){var n=e.imageMessageIndices[t.id];c["default"].set(e.messages,n,t),c["default"].delete(e.imageMessageIndices,t.id)})),Object(u["a"])(_,M,(function(e){e.messages=[],e.rooms=[],e.people=[],e.room=q})),_),actions:(w={},Object(u["a"])(w,V["b"],(function(e){return J(e)})),Object(u["a"])(w,V["d"],(function(e){return H(e,[B])})),Object(u["a"])(w,V["c"],(function(e,t){return e.commit(M),z(e,t)})),Object(u["a"])(w,V["e"],(function(e){return H(e,[$])})),Object(u["a"])(w,V["a"],(function(e,t){return Object(v["e"])(e.state.room.id,t)})),Object(u["a"])(w,V["f"],(function(e,t){var n=e.getters,r=n[U["d"]];return Object(v["g"])({room:{id:r.id,name:r.name},invitee:t})})),w)};function J(e){return W.apply(this,arguments)}function W(){return W=Object(d["a"])(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=Object(v["l"])((function(e){t.commit(S,e.reduce((function(e,t){return e[t.order]=t,e}),Object(T["a"])(t.state.rooms)))})),t.state.unsubscribes[B]=n,e.abrupt("return",n);case 3:case"end":return e.stop()}}),e)}))),W.apply(this,arguments)}function z(e,t){return K.apply(this,arguments)}function K(){return K=Object(d["a"])(regeneratorRuntime.mark((function e(t,n){var r,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return r=function(e){return{id:Object(A["a"])(),type:v["b"].Type.System,contentType:G.Text,content:e,sender:{id:"",name:""},createdAt:Date.now()}},a=Object(v["k"])(n,(function(e,n){switch(e){case v["a"].ROOM_UPDATED:t.commit(C,n);break;case v["a"].USER_JOINED:t.commit(D,r("".concat(n.name,"님이 입장했습니다."))),t.commit(N,n);break;case v["a"].USER_LEAVE:t.commit(D,r("".concat(n.name,"님이 퇴장했습니다."))),t.commit(P,n);break;case v["a"].NEW_MESSAGE:t.commit(D,n);break;case v["a"].IMAGE_UPLOADED:t.commit(L,n);break;case v["a"].USER_LIST_LOADED:t.commit(x,n);break}})),t.state.unsubscribes[$]=a,e.abrupt("return",a);case 4:case"end":return e.stop()}}),e)}))),K.apply(this,arguments)}function H(e,t){return X.apply(this,arguments)}function X(){return X=Object(d["a"])(regeneratorRuntime.mark((function e(t,n){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Promise.all(n.map((function(e){var n=t.state.unsubscribes[e];if(null!=n)return c["default"].delete(t.state.unsubscribes,e),n.then((function(e){return e()}))})));case 2:case"end":return e.stop()}}),e)}))),X.apply(this,arguments)}var Y,Q,Z=F,ee=(n("4de4"),n("30e6")),te={state:function(){var e;return e={},Object(u["a"])(e,g["a"].MESSAGE,{current:null,queue:[]}),Object(u["a"])(e,g["a"].INVITATION,{current:null,queue:[]}),Object(u["a"])(e,g["a"].CONFIRM_INVITATION,{current:null,queue:[]}),e},getters:(Y={},Object(u["a"])(Y,ee["c"],(function(e){return e[g["a"].MESSAGE].current})),Object(u["a"])(Y,ee["b"],(function(e){return e[g["a"].INVITATION].current})),Object(u["a"])(Y,ee["a"],(function(e){return e[g["a"].CONFIRM_INVITATION].current})),Y),actions:(Q={},Object(u["a"])(Q,O["b"],(function(e,t){var n=t.dialogType,r=t.params;switch(n){case g["a"].MESSAGE:oe(e,r);break;case g["a"].INVITATION:re(e,r);break;case g["a"].CONFIRM_INVITATION:ae(e,r);break}})),Object(u["a"])(Q,O["a"],(function(e,t){e.state[t].current=null,setTimeout((function(){e.state[t].current=e.state[t].queue.pop()||null}),100)})),Q)};function ne(e,t){var n=e.state,r=(e.dispatch,t.dialogType),a=t.params;null!=n[r].current?n[r].queue.unshift(a):n[r].current=a}function re(e,t){var n=e.getters[h["a"]],r=e.getters[U["d"]];ne(e,{dialogType:g["a"].INVITATION,params:{usersPromise:Object(v["f"])().then((function(e){return e.filter((function(e){return n.uid!==e.id&&e.currentRoomId!==r.id}))})),handleOk:t.handleOk}})}function ae(e,t){ne(e,{dialogType:g["a"].CONFIRM_INVITATION,params:t})}function oe(e,t){ne(e,{dialogType:g["a"].MESSAGE,params:t})}var ce=te,ie=n("a665"),ue=n("70be"),se={modules:{session:R,chat:Z,dialog:ce},state:function(){return{isBusy:!0}},getters:Object(u["a"])({},ie["a"],(function(e){return e.isBusy})),mutations:Object(u["a"])({},ue["a"],(function(e,t){e.isBusy=t}))},de=se;c["default"].use(i["a"]);t["a"]=new i["a"].Store(de)},1887:function(e,t,n){},"26b2":function(e,t,n){"use strict";n.d(t,"c",(function(){return r})),n.d(t,"d",(function(){return a})),n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return c}));var r="chat.getRooms",a="chat.getRoom",o="chat.getMessages",c="chat.getPeople"},"30e6":function(e,t,n){"use strict";n.d(t,"c",(function(){return r})),n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return o}));var r="dialog.getCurrentMessageDialog",a="dialog.getCurrentInvitationDialog",o="dialog.getCurrentConfirmInvitationDialog"},4037:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return a})),n.d(t,"a",(function(){return o}));var r="session.signIn",a="session.signOut",o="root.checkUserSession"},"4f76":function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e["MESSAGE"]="message",e["INVITATION"]="invitation",e["CONFIRM_INVITATION"]="confirm"}(r||(r={}))},5089:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return a})),n.d(t,"d",(function(){return o})),n.d(t,"a",(function(){return c}));var r="session.isConnecting",a="session.isSignedIn",o="session.isValid",c="session.getProfile"},"59e4":function(e,t,n){},"5e44":function(e,t,n){"use strict";var r;(function(e){e["Main"]="Main",e["ChatRoomList"]="ChatRoomList",e["ChatRoom"]="ChatRoom"})(r||(r={})),t["a"]=r},"70be":function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r="root.setBusy"},7548:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));n("99af"),n("96cf");var r=n("1da1"),a=n("2fe1"),o=n("0613"),c=n("70be"),i=Object(a["a"])((function(e,t){var n,a,i=(null===(n=e.methods)||void 0===n?void 0:n[t])||e[t],u=(null===(a=e.methods)||void 0===a?void 0:a[t])?e.methods:e;if(!i)throw new Error("".concat(t," of ").concat(i));u[t]=Object(r["a"])(regeneratorRuntime.mark((function e(){var t,n,r,a=arguments;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:for(o["a"].commit(c["a"],!0),e.prev=1,t=a.length,n=new Array(t),r=0;r<t;r++)n[r]=a[r];return e.next=5,i.apply(this,n);case 5:return e.abrupt("return",e.sent);case 6:return e.prev=6,o["a"].commit(c["a"],!1),e.finish(6);case 9:case"end":return e.stop()}}),e,this,[[1,,6,9]])})))}));function u(e,t){i(e,t)}},"7bd1":function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return u})),n.d(t,"c",(function(){return b})),n.d(t,"h",(function(){return v})),n.d(t,"i",(function(){return O})),n.d(t,"e",(function(){return j})),n.d(t,"m",(function(){return x})),n.d(t,"j",(function(){return w})),n.d(t,"n",(function(){return R})),n.d(t,"k",(function(){return A})),n.d(t,"l",(function(){return T})),n.d(t,"f",(function(){return I})),n.d(t,"g",(function(){return E})),n.d(t,"d",(function(){return _}));n("4160"),n("a15b"),n("d81d"),n("b0c0"),n("d3b7"),n("3ca3"),n("159b"),n("ddb0"),n("bf19");var r,a=n("5530"),o=(n("96cf"),n("1da1")),c=n("59ca"),i=n.n(c);n("ea7b"),n("66ce"),n("588e"),n("000b");(function(e){(function(e){e["User"]="USER",e["System"]="SYSTEM"})(e.Type||(e.Type={})),function(e){e["Text"]="TEXT",e["Image"]="IMAGE"}(e.ContentType||(e.ContentType={}))})(r||(r={}));var u,s=n("5986"),d=r.ContentType,f=i.a.database.ServerValue,l=i.a.initializeApp(s),p=l.auth(),m=l.database(),h=l.storage();function b(){return new Promise((function(e,t){var n=p.onAuthStateChanged(function(){var r=Object(o["a"])(regeneratorRuntime.mark((function r(a){var o;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return n(),r.prev=1,r.next=4,G().once("value");case 4:o=r.sent,e(o.val()),r.next=11;break;case 8:r.prev=8,r.t0=r["catch"](1),t(r.t0);case 11:case"end":return r.stop()}}),r,null,[[1,8]])})));return function(e){return r.apply(this,arguments)}}())}))}function v(e){return g.apply(this,arguments)}function g(){return g=Object(o["a"])(regeneratorRuntime.mark((function e(t){var n,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,p.signInAnonymously();case 2:return n=C(),e.next=5,V().orderByChild("name").equalTo(t).once("value");case 5:if(r=e.sent,!r.exists()){e.next=9;break}throw p.signOut(),new Error("사용중인 이름입니다.");case 9:return e.next=11,Promise.all([G().update({name:t}),n.updateProfile({displayName:t})]);case 11:return e.abrupt("return",n);case 12:case"end":return e.stop()}}),e)}))),g.apply(this,arguments)}function O(){return G().remove(),p.signOut()}function j(e,t){var n=C(),c=Object(a["a"])(Object(a["a"])({},t),{},{sender:{id:n.uid,name:n.displayName},createdAt:f.TIMESTAMP});if(t.contentType===r.ContentType.Image){var i=t.content;return c.content=null,i.map(function(){var t=Object(o["a"])(regeneratorRuntime.mark((function t(r){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.abrupt("return",P(e).child("messages").push(c).then((function(t){var a=[e,t.key,(new Date).toISOString(),n.uid,r.name].join("/");y(a,r).then((function(e){return t.update({content:e})}))})));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}return P(e).child("messages").push(c)}function y(e,t){return h.ref(e).put(t).then((function(e){return e.ref.getDownloadURL()}))}function I(){return k.apply(this,arguments)}function k(){return k=Object(o["a"])(regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,V().orderByChild("online").equalTo(!0).once("value");case 2:return t=e.sent,n=[],t.forEach((function(e){var t=e.val();n.push({id:e.key,name:t.name,currentRoomId:t.currentRoomId})})),e.abrupt("return",n);case 6:case"end":return e.stop()}}),e)}))),k.apply(this,arguments)}function E(e){var t=e.room,n=e.invitee,r=C(),a=r.uid,o=r.displayName;return B().child(n).push({room:t,inviter:{id:a,name:o},createdAt:f.TIMESTAMP})}function _(e){var t=C(),n=t.uid;return B().child(n).child(e).remove()}function w(e){return p.onAuthStateChanged((function(t){var n=(null===t||void 0===t?void 0:t.toJSON())||null;e(n)}))}function R(e){var t=C(),n=t.uid,r=B().child(n).orderByChild("createdAt").startAt(Date.now());return r.on("child_added",(function(t){return e(Object(a["a"])(Object(a["a"])({},t.val()),{},{id:t.key}))})),function(){return r.off()}}function T(e){return new Promise((function(t){var n=M().orderByChild("order");n.on("value",(function(r){var o=[];r.forEach((function(e){var t=e.val();o.push(Object(a["a"])(Object(a["a"])({},t),{},{countPeople:t.countPeople||0,id:e.key}))})),e(o),t((function(){return n.off()}))}))}))}function A(e,t){return S.apply(this,arguments)}function S(){return S=Object(o["a"])(regeneratorRuntime.mark((function e(t,n){var r,c,i,s,l,p,m,h,b,v,g;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return r=C(),c=r.uid,i=L(t),e.next=4,i.once("value");case 4:return s=e.sent,e.next=7,$(t);case 7:return l=e.sent,p=D(t),m=i.orderByChild("joinedAt").startAt(l.joinedAt),h=U(t).orderByChild("createdAt").startAt(l.joinedAt),b=m.ref.child(c).onDisconnect(),v=p.onDisconnect(),e.next=15,Promise.all([b.remove(),v.update({countPeople:f.increment(-1)})]);case 15:return g=[],s.forEach((function(e){g.push(Object(a["a"])(Object(a["a"])({},e.val()),{},{id:e.key}))})),n(u.USER_LIST_LOADED,g),p.on("value",(function(e){var t=e.val();n(u.ROOM_UPDATED,Object(a["a"])(Object(a["a"])({},t),{},{id:e.key}))})),m.on("child_added",(function(e){var t=e.val();n(u.USER_JOINED,t)})),m.on("child_removed",(function(e){var t=e.val();n(u.USER_LEAVE,t)})),h.on("child_added",(function(e){var t=e.val(),r=Object(a["a"])(Object(a["a"])({},t),{},{id:e.key});n(u.NEW_MESSAGE,r)})),h.on("child_changed",(function(e){var t=e.val();t.contentType===d.Image&&t.content&&n(u.IMAGE_UPLOADED,Object(a["a"])(Object(a["a"])({},t),{},{id:e.key}))})),e.abrupt("return",Object(o["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return p.off(),m.off(),h.off(),e.next=5,F(t);case 5:return e.next=7,Promise.all([v.cancel(),b.cancel()]);case 7:case"end":return e.stop()}}),e)}))));case 24:case"end":return e.stop()}}),e)}))),S.apply(this,arguments)}function x(e){var t=C(),n=t.uid,r=m.ref("/sessions/".concat(n)),a=m.ref(".info/connected"),o=Promise.resolve();return a.on("value",(function(t){o=o.then((function(){if(!1!==t.val())return r.onDisconnect().update({online:!1,lastChanged:f.TIMESTAMP}).then((function(){r.update({online:!0,lastChanged:f.TIMESTAMP}),e(!0)}));e(!1)}))})),function(){return a.off()}}function C(){var e=p.currentUser;if(null==e)throw new Error("Unauthorized");return e}function M(){return m.ref("chatRoomStates")}function D(e){return M().child(e)}function N(){return m.ref("chatRooms")}function P(e){return N().child(e)}function L(e){return P(e).child("users")}function U(e){return P(e).child("messages")}function V(){return m.ref("sessions")}function G(){return V().child(C().uid)}function B(){return m.ref("invitations")}function $(e){return q.apply(this,arguments)}function q(){return q=Object(o["a"])(regeneratorRuntime.mark((function e(t){var n,r,a,o,c,i,u,s,d;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=C(),r=n.uid,a=n.displayName,o=L(t),c=o.child(r),i=D(t),u=G(),e.prev=5,e.next=8,c.set({id:r,name:a,joinedAt:f.TIMESTAMP});case 8:return e.next=10,o.once("value");case 10:return s=e.sent,e.next=13,i.update({countPeople:s.numChildren()});case 13:return e.next=15,u.update({currentRoomId:t});case 15:return e.next=17,c.once("value");case 17:return d=e.sent,e.abrupt("return",d.val());case 21:throw e.prev=21,e.t0=e["catch"](5),u.update({currentRoomId:null}),c.remove(),e.t0;case 26:case"end":return e.stop()}}),e,null,[[5,21]])}))),q.apply(this,arguments)}function F(e){return J.apply(this,arguments)}function J(){return J=Object(o["a"])(regeneratorRuntime.mark((function e(t){var n,r,a,o,c,i,u;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=C(),r=n.uid,a=D(t),o=L(t),c=o.child(r),i=G(),e.prev=5,e.next=8,c.remove();case 8:return e.next=10,o.once("value");case 10:return u=e.sent,e.next=13,a.update({countPeople:u.numChildren()});case 13:return e.next=15,i.update({currentRoomId:null});case 15:e.next=21;break;case 17:e.prev=17,e.t0=e["catch"](5),i.update({currentRoomId:null}),c.remove();case 21:case"end":return e.stop()}}),e,null,[[5,17]])}))),J.apply(this,arguments)}(function(e){e[e["ROOM_UPDATED"]=0]="ROOM_UPDATED",e[e["USER_LIST_LOADED"]=1]="USER_LIST_LOADED",e[e["USER_JOINED"]=2]="USER_JOINED",e[e["USER_LEAVE"]=3]="USER_LEAVE",e[e["NEW_MESSAGE"]=4]="NEW_MESSAGE",e[e["IMAGE_UPLOADED"]=5]="IMAGE_UPLOADED"})(u||(u={}))},"831f":function(e,t,n){},8594:function(e,t,n){},"96e4":function(e,t,n){},a47c:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"d",(function(){return a})),n.d(t,"c",(function(){return o})),n.d(t,"e",(function(){return c})),n.d(t,"a",(function(){return i})),n.d(t,"f",(function(){return u}));var r="chat.enterLobby",a="chat.leaveLobby",o="chat.enterRoom",c="chat.leaveRoom",i="chat.dispatchMessage",u="chat.sendInvitation"},a665:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r="root.isBusy"},afbc:function(e,t,n){"use strict";n("b0c0"),n("96cf");var r=n("1da1"),a=n("2b0e"),o=n("8c4f"),c=(n("d3b7"),n("5e44")),i={path:"/",name:c["a"].Main,component:function(){return n.e("main~31ecd969").then(n.bind(null,"73eb"))}},u=i,s={path:"/rooms/:roomId",name:c["a"].ChatRoom,component:function(){return Promise.all([n.e("vendors~chat-room~chat-room-list~987e6011"),n.e("vendors~chat-room~d939e436"),n.e("chat-room~21833f8f")]).then(n.bind(null,"f3f9"))}},d=s,f={path:"/rooms",name:c["a"].ChatRoomList,component:function(){return Promise.all([n.e("vendors~chat-room~chat-room-list~987e6011"),n.e("chat-room-list~21833f8f")]).then(n.bind(null,"66ef"))}},l=f,p=[u,l,d,{path:"*",redirect:{name:c["a"].Main}}],m={mode:"history",base:"/vue-firebase-chat/",routes:p},h=m,b=n("0613"),v=n("5089");a["default"].use(o["a"]);var g=new o["a"](h);function O(e,t,n){return j.apply(this,arguments)}function j(){return j=Object(r["a"])(regeneratorRuntime.mark((function e(t,n,r){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t.name===c["a"].Main||b["a"].getters[v["c"]]?r():r({name:c["a"].Main});case 1:case"end":return e.stop()}}),e)}))),j.apply(this,arguments)}g.beforeEach(O);t["a"]=g},b446:function(e,t,n){"use strict";var r=n("2638"),a=n.n(r),o=n("d4ec"),c=n("bee2"),i=n("262e"),u=n("2caf"),s=n("9ab4"),d=n("48d3"),f=n("60a3"),l=(n("96e4"),function(e){Object(i["a"])(n,e);var t=Object(u["a"])(n);function n(){return Object(o["a"])(this,n),t.apply(this,arguments)}return Object(c["a"])(n,[{key:"render",value:function(){var e=arguments[0];return e("button",a()([{staticClass:"button",class:this.styleVariant,attrs:{type:this.buttonType}},{on:this.$listeners}]),[this.$slots.default])}},{key:"buttonType",get:function(){return this.$attrs.type||"button"}},{key:"styleVariant",get:function(){return this.variant?"button_".concat(this.variant):""}}]),n}(d["Component"]));Object(s["__decorate"])([Object(f["b"])(String)],l.prototype,"variant",void 0),l=Object(s["__decorate"])([f["a"]],l),t["a"]=l},baef:function(e,t,n){},c592:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}));var r="dialog.nextDialog",a="dialog.requestDialog"},cd49:function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d");var r=n("2b0e"),a=n("60a3"),o=n("d4ec"),c=n("bee2"),i=n("262e"),u=n("2caf"),s=n("9ab4"),d=n("4bb5"),f=(n("8594"),n("a665")),l=(n("baef"),function(e){Object(i["a"])(n,e);var t=Object(u["a"])(n);function n(){return Object(o["a"])(this,n),t.apply(this,arguments)}return Object(c["a"])(n,[{key:"render",value:function(){var e=arguments[0];return e("div",{class:"spinner"})}}]),n}(a["d"]));l=Object(s["__decorate"])([a["a"]],l);var p=l;n("59e4"),n("99af"),n("d81d");var m=n("48d3"),h=(n("1887"),n("b446")),b=function(e){Object(i["a"])(n,e);var t=Object(u["a"])(n);function n(){return Object(o["a"])(this,n),t.apply(this,arguments)}return Object(c["a"])(n,[{key:"render",value:function(){var e=this,t=arguments[0];return t("div",{class:"dialog-background"},[t("div",{class:"dialog-window"},[t("div",{class:"dialog-body"},[this.$slots.default]),t("div",{class:"dialog-footer"},[this.closeLabel&&t(h["a"],{attrs:{variant:"light"},class:"dialog-footer__close-button",on:{click:function(){return e.$emit("close")}}},[this.closeLabel]),t(h["a"],{attrs:{variant:"yellow"},on:{click:function(){return e.$emit("ok")}}},[this.okLabel])])])])}}]),n}(m["Component"]);Object(s["__decorate"])([Object(a["b"])({type:String,default:"확인"})],b.prototype,"okLabel",void 0),Object(s["__decorate"])([Object(a["b"])({type:String,default:"닫기"})],b.prototype,"closeLabel",void 0),b=Object(s["__decorate"])([a["a"]],b);var v=b;var g=function(e){Object(i["a"])(n,e);var t=Object(u["a"])(n);function n(){return Object(o["a"])(this,n),t.apply(this,arguments)}return Object(c["a"])(n,[{key:"render",value:function(){var e=this,t=arguments[0];return t(v,{attrs:{okLabel:this.params.okText,closeLabel:this.params.closeText},on:{ok:function(){return e.$emit("ok")},close:function(){return e.$emit("close")}}},[t("div",{class:"dialog-content"},[this.message])])}},{key:"message",get:function(){var e=this.$createElement;return[].concat(this.params.message).map((function(t,n){return e("div",{key:n,class:"dialog-content-message"},[t])}))}}]),n}(m["Component"]);Object(s["__decorate"])([Object(a["b"])(Object)],g.prototype,"params",void 0),g=Object(s["__decorate"])([a["a"]],g);var O=g;var j=n("4f76"),y=n("30e6"),I=(n("4de4"),n("b0c0"),n("2638")),k=n.n(I),E=(n("96cf"),n("1da1")),_=(n("831f"),n("7548")),w=function(e){Object(i["a"])(n,e);var t=Object(u["a"])(n);function n(){var e;return Object(o["a"])(this,n),e=t.apply(this,arguments),e.users=null,e.guest="",e}return Object(c["a"])(n,[{key:"onOk",value:function(){var e=Object(E["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:this.guest&&this.$emit("ok",this.guest);case 1:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"mounted",value:function(){var e=Object(E["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.params.usersPromise;case 2:t=e.sent,this.users=t||[],this.users.length&&(this.guest=this.users[0].id);case 5:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"render",value:function(){var e,t=this,n=arguments[0];return n(v,{attrs:{okLabel:"초대"},on:{ok:this.onOk,close:function(){return t.$emit("close")}}},[n("div",{class:"dialog-content"},[n("label",{class:"dialog-select-user-label",attrs:{for:"user"}},["초대할 사람을 선택하세요."]),n("select",k()([{on:{change:function(e){var n=Array.prototype.filter.call(e.target.options,(function(e){return e.selected})).map((function(e){return"_value"in e?e._value:e.value}));t.guest=e.target.multiple?n:n[0]}},attrs:{id:"user"},domProps:{value:this.guest},class:"dialog-select-user"},{directives:[{name:"model",value:t.guest,modifiers:{}}]}]),[(null===(e=this.users)||void 0===e?void 0:e.length)&&this.users.map((function(e){return n("option",{key:e.id,domProps:{value:e.id}},[e.name])})),this.users&&!this.users.length&&n("option",{attrs:{disabled:!0,value:""}},["초대할 사람이 없습니다."])])])])}}]),n}(m["Component"]);Object(s["__decorate"])([Object(a["b"])(Object)],w.prototype,"params",void 0),Object(s["__decorate"])([_["a"]],w.prototype,"onOk",null),Object(s["__decorate"])([_["a"]],w.prototype,"mounted",null),w=Object(s["__decorate"])([Object(a["a"])({components:{VModal:v}})],w);var R=w;var T=n("c592"),A=function(e){Object(i["a"])(n,e);var t=Object(u["a"])(n);function n(){return Object(o["a"])(this,n),t.apply(this,arguments)}return Object(c["a"])(n,[{key:"render",value:function(){var e=this,t=arguments[0];return t(v,{attrs:{okLabel:"수락"},on:{ok:function(){return e.$emit("ok",e.params.room.id)},close:function(){return e.$emit("close")}}},[t("div",{class:"dialog-content"},[t("div",{class:"dialog-content-message"},[t("strong",[this.params.inviter.name])," 님이,"]),t("div",{class:"dialog-content-message"},[t("strong",[this.params.room.name])," 방으로 초대했습니다."])])])}}]),n}(m["Component"]);Object(s["__decorate"])([Object(a["b"])(Object)],A.prototype,"params",void 0),A=Object(s["__decorate"])([a["a"]],A);var S=A;var x=function(e){Object(i["a"])(n,e);var t=Object(u["a"])(n);function n(){return Object(o["a"])(this,n),t.apply(this,arguments)}return Object(c["a"])(n,[{key:"handleOk",value:function(e,t,n){var r;null===(r=t.handleOk)||void 0===r||r.call(t,n),this.nextDialog(e)}},{key:"handleClose",value:function(e,t){var n;null===(n=t.handleClose)||void 0===n||n.call(t),this.nextDialog(e)}},{key:"render",value:function(){var e=this,t=arguments[0];return t("div",{class:"dialog-container"},[this.currentInvitationDialog&&t(R,{attrs:{params:this.currentInvitationDialog},on:{ok:function(t){return e.handleOk(j["a"].INVITATION,e.currentInvitationDialog,t)},close:function(){return e.handleClose(j["a"].INVITATION,e.currentInvitationDialog)}}}),this.currentConfirmInvitationDialog&&t(S,{attrs:{params:this.currentConfirmInvitationDialog},on:{ok:function(t){return e.handleOk(j["a"].CONFIRM_INVITATION,e.currentConfirmInvitationDialog,t)},close:function(){return e.handleClose(j["a"].CONFIRM_INVITATION,e.currentConfirmInvitationDialog)}}}),this.currentMessageDialog&&t(O,{attrs:{params:this.currentMessageDialog},on:{ok:function(){return e.handleOk(j["a"].MESSAGE,e.currentMessageDialog)},close:function(){return e.handleClose(j["a"].MESSAGE,e.currentMessageDialog)}}})])}}]),n}(a["d"]);Object(s["__decorate"])([Object(d["b"])(y["c"])],x.prototype,"currentMessageDialog",void 0),Object(s["__decorate"])([Object(d["b"])(y["b"])],x.prototype,"currentInvitationDialog",void 0),Object(s["__decorate"])([Object(d["b"])(y["a"])],x.prototype,"currentConfirmInvitationDialog",void 0),Object(s["__decorate"])([Object(d["a"])(T["a"])],x.prototype,"nextDialog",void 0),x=Object(s["__decorate"])([a["a"]],x);var C=x;var M=function(e){Object(i["a"])(n,e);var t=Object(u["a"])(n);function n(){return Object(o["a"])(this,n),t.apply(this,arguments)}return Object(c["a"])(n,[{key:"render",value:function(){var e=arguments[0];return e("div",{attrs:{id:"app"}},[e("router-view"),e(C),e("div",{class:"global-spinner",directives:[{name:"show",value:this.isBusy}]},[e(p)])])}}]),n}(a["d"]);Object(s["__decorate"])([Object(d["b"])(f["a"])],M.prototype,"isBusy",void 0),M=Object(s["__decorate"])([a["a"]],M);var D=M;var N=n("afbc"),P=n("0613");r["default"].config.productionTip=!1,a["a"].registerHooks(["beforeRouteEnter","beforeRouteUpdate","beforeRouteLeave"]),N["a"].onError((function(e){})),new r["default"]({router:N["a"],store:P["a"],render:function(e){return e(D)}}).$mount("#app")}});
//# sourceMappingURL=app~06837ae4.968c4536.js.map
(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chat-room~21833f8f"],{"03f0":function(e,t,a){},"0761":function(e,t,a){},"10f9":function(e,t,a){},"3fd9":function(e,t,a){"use strict";var s=a("d4ec"),n=a("bee2"),i=a("262e"),r=a("2caf"),o=a("9ab4"),c=a("60a3"),l=(a("9ece"),function(e){Object(i["a"])(a,e);var t=Object(r["a"])(a);function a(){return Object(s["a"])(this,a),t.apply(this,arguments)}return Object(n["a"])(a,[{key:"render",value:function(){var e=arguments[0];return e("div",{class:"page"},[this.$slots.default])}}]),a}(c["d"]));l=Object(o["__decorate"])([c["a"]],l),t["a"]=l},"488b":function(e,t,a){"use strict";var s=a("d4ec"),n=a("bee2"),i=a("262e"),r=a("2caf"),o=a("9ab4"),c=a("60a3"),l=(a("56ae"),a("3fd9")),u=function(e){Object(i["a"])(a,e);var t=Object(r["a"])(a);function a(){return Object(s["a"])(this,a),t.apply(this,arguments)}return Object(n["a"])(a,[{key:"render",value:function(){var e=arguments[0];return e(l["a"],[this.$slots.default])}}]),a}(c["d"]);u=Object(o["__decorate"])([c["a"]],u),t["a"]=u},"4bd1":function(e,t,a){},"53d4":function(e,t,a){"use strict";var s=a("d4ec"),n=a("bee2"),i=a("262e"),r=a("2caf"),o=a("9ab4"),c=a("60a3"),l=(a("10f9"),function(e){Object(i["a"])(a,e);var t=Object(r["a"])(a);function a(){return Object(s["a"])(this,a),t.apply(this,arguments)}return Object(n["a"])(a,[{key:"render",value:function(){var e=arguments[0];return e("div",{class:"chat-frame-header"},[this.$slots.default])}}]),a}(c["d"]));l=Object(o["__decorate"])([c["a"]],l),t["a"]=l},"56ae":function(e,t,a){},"5b06":function(e,t,a){},"5c9d":function(e,t,a){},"7b9b":function(e,t,a){},"96b5":function(e,t,a){"use strict";var s=a("d4ec"),n=a("bee2"),i=a("262e"),r=a("2caf"),o=a("9ab4"),c=a("60a3"),l=(a("e19b"),function(e){Object(i["a"])(a,e);var t=Object(r["a"])(a);function a(){return Object(s["a"])(this,a),t.apply(this,arguments)}return Object(n["a"])(a,[{key:"render",value:function(){var e=arguments[0];return e("div",{class:"chat-frame-body"},[this.$slots.default])}}]),a}(c["d"]));l=Object(o["__decorate"])([c["a"]],l),t["a"]=l},"9d2c":function(e,t,a){"use strict";var s=a("d4ec"),n=a("bee2"),i=a("262e"),r=a("2caf"),o=a("9ab4"),c=a("60a3"),l=(a("dcd2"),function(e){Object(i["a"])(a,e);var t=Object(r["a"])(a);function a(){return Object(s["a"])(this,a),t.apply(this,arguments)}return Object(n["a"])(a,[{key:"render",value:function(){var e=arguments[0];return e("span",{class:"badge"},[this.$slots.default])}}]),a}(c["d"]));l=Object(o["__decorate"])([c["a"]],l),t["a"]=l},"9ece":function(e,t,a){},c2b9:function(e,t,a){},dcd2:function(e,t,a){},e19b:function(e,t,a){},f3f9:function(e,t,a){"use strict";a.r(t);a("b0c0"),a("d3b7"),a("ac1f"),a("5319"),a("96cf");var s=a("1da1"),n=a("d4ec"),i=a("bee2"),r=a("262e"),o=a("2caf"),c=a("9ab4"),l=a("60a3"),u=a("4bb5"),d=(a("03f0"),a("26b2")),h=a("5e44"),p=a("9d2c"),b=a("b446"),m=(a("d81d"),a("48d3")),f=(a("5b06"),function(e){Object(r["a"])(a,e);var t=Object(o["a"])(a);function a(){return Object(n["a"])(this,a),t.apply(this,arguments)}return Object(i["a"])(a,[{key:"render",value:function(){var e=this,t=arguments[0];return t("ul",{class:"message-list"},[this.messageList.map((function(a){return t("li",{key:a.id,class:"message-list-item"},[e.$scopedSlots.default({message:a})])}))])}}]),a}(m["Component"]));Object(c["__decorate"])([Object(l["b"])(Array)],f.prototype,"messageList",void 0),f=Object(c["__decorate"])([l["a"]],f);var v=f;var y=a("2638"),g=a.n(y),_=(a("7b9b"),a("5a0c")),O=a.n(_),j=a("23ad"),k=a.n(j);a("f20b");function M(e){return O()(e).format("LL A hh:mm:ss")}O.a.extend(k.a),O.a.locale("ko");var x=a("7bd1"),w=function(e){Object(r["a"])(a,e);var t=Object(o["a"])(a);function a(){var e;return Object(n["a"])(this,a),e=t.apply(this,arguments),e.imageLoaded=!1,e.imageErrored=!1,e}return Object(i["a"])(a,[{key:"handleImageLoaded",value:function(){this.imageLoaded=!0,this.$emit("messageLoaded",this.message)}},{key:"handleImageError",value:function(){this.imageErrored=!0,this.handleImageLoaded()}},{key:"mounted",value:function(){this.$emit("messageLoaded",this.message)}},{key:"render",value:function(){var e=arguments[0];return e("div",{staticClass:"message-list-item-user",class:{"message-list-item-user-me":this.isMyMessage}},[!this.isMyMessage&&e("div",{class:"message-list-item-user-initial"},[this.senderInitial]),e("div",{staticClass:"message-list-item-user-text-box",class:"message-list-item-user-text-box_align_".concat(this.isMyMessage?"right":"left")},[!this.isMyMessage&&e("div",{class:"message-list-item-user-sender"},[this.message.sender.name]),e("div",{staticClass:"message-list-item-user-balloon",class:"message-list-item-user-balloon_align_".concat(this.isMyMessage?"right":"left")},[e("div",{staticClass:"message-list-item-user-balloon__arrow",class:"message-list-item-user-balloon__arrow_direction_".concat(this.isMyMessage?"right":"left")}),e("div",{staticClass:"message-list-item-user-balloon__content",class:{"message-list-item-user-balloon__content_color_yellow":this.isMyMessage}},[this.isText&&e("pre",{class:"message-list-item-user-balloon__content-text"},[this.message.content])||this.isImage&&e("div",{class:"message-list-item-user-balloon__content-image-wrapper"},[this.imageErrored?"이미지 불러오기 실패":e("img",g()([{class:"message-list-item-user-balloon__content-image",attrs:{src:this.content,alt:""}},{on:{"~load":this.handleImageLoaded,"~error":this.handleImageError}}])),!this.imageLoaded&&e("div",{staticClass:"absolute spinner",class:{spinner_color_light:this.isMyMessage}})]),e("span",{staticClass:"message-list-item-user-balloon__datetime",class:{"message-list-item-user-balloon__datetime_align_right":this.isMyMessage}},[M(this.message.createdAt)])])])])])}},{key:"senderInitial",get:function(){return this.message.sender.name[0]}},{key:"isText",get:function(){return this.message.contentType===x["b"].ContentType.Text}},{key:"isImage",get:function(){return this.message.contentType===x["b"].ContentType.Image}},{key:"content",get:function(){return this.message.content||null}}]),a}(l["d"]);Object(c["__decorate"])([Object(l["b"])({type:Object,required:!0})],w.prototype,"message",void 0),Object(c["__decorate"])([Object(l["b"])(Boolean)],w.prototype,"isMyMessage",void 0),w=Object(c["__decorate"])([l["a"]],w);var C=w;a("4bd1");var E=function(e){Object(r["a"])(a,e);var t=Object(o["a"])(a);function a(){return Object(n["a"])(this,a),t.apply(this,arguments)}return Object(i["a"])(a,[{key:"mounted",value:function(){this.$emit("messageLoaded",this.message)}},{key:"render",value:function(){var e=arguments[0];return e("div",{class:"message-list-item-system"},[this.message.content])}}]),a}(l["d"]);Object(c["__decorate"])([Object(l["b"])({type:Object,required:!0})],E.prototype,"message",void 0),E=Object(c["__decorate"])([l["a"]],E);var I=E;var T=function(e){Object(r["a"])(a,e);var t=Object(o["a"])(a);function a(){return Object(n["a"])(this,a),t.apply(this,arguments)}return Object(i["a"])(a,[{key:"render",value:function(){var e=arguments[0],t=this.isSystemMessage?I:C;return e(t,g()([{},{props:{message:this.message,isMyMessage:this.isMyMessage}},{},{on:this.$listeners}]))}},{key:"isSystemMessage",get:function(){return this.message.type===x["b"].Type.System}}]),a}(m["Component"]);Object(c["__decorate"])([Object(l["b"])({type:Object,required:!0})],T.prototype,"message",void 0),Object(c["__decorate"])([Object(l["b"])(Boolean)],T.prototype,"isMyMessage",void 0),T=Object(c["__decorate"])([l["a"]],T);var S=T;a("fb6a"),a("5c9d");var L=function(e){Object(r["a"])(a,e);var t=Object(o["a"])(a);function a(){return Object(n["a"])(this,a),t.apply(this,arguments)}return Object(i["a"])(a,[{key:"onChange",value:function(){this.$emit("selectFile",[].slice.apply(this.fileElement.files)),this.reset()}},{key:"reset",value:function(){this.fileElement.value=""}},{key:"render",value:function(){var e=arguments[0];return e("label",{staticClass:"file",class:{disabled:this.$attrs.disabled}},[this.$slots.default,e("input",g()([{},{attrs:this.$attrs},{ref:"fileElement",attrs:{type:"file",hidden:!0},on:{change:this.onChange}}]))])}}]),a}(m["Component"]);Object(c["__decorate"])([Object(l["c"])()],L.prototype,"fileElement",void 0),L=Object(c["__decorate"])([Object(l["a"])({inheritAttrs:!1})],L);var $=L;var R,B=a("488b"),A=a("53d4"),P=a("96b5");a("498a"),a("c2b9");(function(e){e[e["Enter"]=13]="Enter"})(R||(R={}));var F=function(e){Object(r["a"])(a,e);var t=Object(o["a"])(a);function a(){var e;return Object(n["a"])(this,a),e=t.apply(this,arguments),e.sendButtonEnabled=!1,e}return Object(i["a"])(a,[{key:"handleInput",value:function(e){this.sendButtonEnabled="".concat(e.target.value).trim().length>0}},{key:"handleKeyDown",value:function(e){e.keyCode===R.Enter&&e.preventDefault(),this.sendButtonEnabled&&e.keyCode===R.Enter&&(e.altKey?this.textareaElement.value+="\n":this.emitText())}},{key:"handleSendClick",value:function(){this.sendButtonEnabled&&(this.emitText(),this.focusInput())}},{key:"emitText",value:function(){var e=this.textareaElement.value;e&&(this.$emit("textSubmitted",e),this.textareaElement.value="",this.sendButtonEnabled=!1)}},{key:"focusInput",value:function(){this.textareaElement.focus()}},{key:"render",value:function(){var e=arguments[0];return e("div",{class:"chat-frame-input-panel"},[e("div",{class:"chat-frame-input-panel__menu"},[this.$scopedSlots.menus({focusInput:this.focusInput,disabled:this.disabled})]),e("div",{class:"chat-frame-input-panel__input-area"},[e("label",{attrs:{for:"inputBox"},class:"sr-only"},["입력상자"]),e("textarea",{attrs:{id:"inputBox",disabled:this.disabled},ref:"textareaElement",class:"chat-frame-input-panel__input",on:{input:this.handleInput,keydown:m["modifiers"].enter(this.handleKeyDown)}}),e("div",{class:"chat-frame-input-panel__send-button-container"},[e(b["a"],{attrs:{type:"submit",disabled:this.disabled||!this.sendButtonEnabled},class:"chat-frame-input-panel__send-button button button_yellow",on:{click:this.handleSendClick}},["전송"])])])])}}]),a}(m["Component"]);Object(c["__decorate"])([Object(l["c"])()],F.prototype,"textareaElement",void 0),Object(c["__decorate"])([Object(l["b"])()],F.prototype,"disabled",void 0),F=Object(c["__decorate"])([l["a"]],F);var q=F;var D=a("a47c"),N=a("7548"),H=a("5089"),K=a("4f76"),Q=(a("0761"),function(e){Object(r["a"])(a,e);var t=Object(o["a"])(a);function a(){return Object(n["a"])(this,a),t.apply(this,arguments)}return Object(i["a"])(a,[{key:"render",value:function(){var e=arguments[0];return e("div",{staticClass:"chat-room-popup"},[e("span",{staticClass:"chat-room-popup__arrow"}),e("ul",{staticClass:"chat-room-popup__body"},[this.people.map((function(t){return e("li",{staticClass:"chat-room-popup__user-name"},["🗣 ",t.name])}))])])}}]),a}(m["Component"]));Object(c["__decorate"])([Object(l["b"])(Array)],Q.prototype,"people",void 0),Q=Object(c["__decorate"])([l["a"]],Q);var G=Q;var J=a("c592"),U=function(e){Object(r["a"])(a,e);var t=Object(o["a"])(a);function a(){var e;return Object(n["a"])(this,a),e=t.apply(this,arguments),e.sendMessageQueue=Promise.resolve(),e.isScrollAtEnd=!0,e.peoplePopupShowed=!1,e}return Object(i["a"])(a,[{key:"handleLeaveClick",value:function(){this.$router.replace({name:h["a"].ChatRoomList})}},{key:"handleInvitationMenuClick",value:function(){this.requestDialog({dialogType:K["a"].INVITATION,params:{handleOk:this.handleSendInvitationOk}})}},{key:"handleSendInvitationOk",value:function(e){return this.sendInvitation(e)}},{key:"handleNewMessageLoaded",value:function(e){var t=e.sender.id===this.profile.uid;(t||this.isScrollAtEnd)&&(this.chatFrameBody.$el.scrollTop=this.messageList.$el.clientHeight-this.chatFrameBody.$el.clientHeight)}},{key:"handleTextSubmitted",value:function(e){this.sendMessage({content:e,contentType:x["b"].ContentType.Text})}},{key:"handleImageSubmitted",value:function(e,t){this.sendMessage({content:e,contentType:x["b"].ContentType.Image}),t()}},{key:"sendMessage",value:function(e){var t=this,a=e.content,s=e.contentType;this.sendMessageQueue=this.sendMessageQueue.then((function(){return t.dispatchMessage({content:a,contentType:s})}))}},{key:"handleChatFrameBodyScroll",value:function(){var e=this.chatFrameBody.$el,t=this.messageList.$el;this.isScrollAtEnd=Math.abs(e.scrollTop+e.clientHeight-t.clientHeight)<2}},{key:"handlePeopleNumberClick",value:function(){this.peoplePopupShowed=!this.peoplePopupShowed}},{key:"watchRoom",value:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!t.id){e.next=4;break}return e.next=3,this.$nextTick();case 3:this.inputPanel.focusInput();case 4:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"beforeRouteEnter",value:function(e,t,a){return new Promise((function(t){a(function(){var a=Object(s["a"])(regeneratorRuntime.mark((function a(s){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,s.enterRoom(e.params.roomId);case 3:a.next=8;break;case 5:a.prev=5,a.t0=a["catch"](0),s.requestDialog({dialogType:K["a"].MESSAGE,params:{message:"🚧 채팅방 연결중 오류가 발생했습니다.",closeText:"",okText:"채팅방 목록으로 이동",handleOk:function(){s.$router.replace({name:h["a"].ChatRoomList})}}});case 8:t();case 9:case"end":return a.stop()}}),a,null,[[0,5]])})));return function(e){return a.apply(this,arguments)}}())}))}},{key:"beforeRouteUpdate",value:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(t,a,s){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.leaveRoom();case 3:return e.next=5,this.enterRoom(t.params.roomId);case 5:s(),e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](0),this.requestDialog({dialogType:K["a"].MESSAGE,params:{message:"🚧 채팅방 연결중 오류가 발생했습니다.",closeText:"",okText:"닫기"}});case 11:case"end":return e.stop()}}),e,this,[[0,8]])})));function t(t,a,s){return e.apply(this,arguments)}return t}()},{key:"beforeRouteLeave",value:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(t,a,s){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:this.leaveRoom(),s();case 2:case"end":return e.stop()}}),e,this)})));function t(t,a,s){return e.apply(this,arguments)}return t}()},{key:"render",value:function(){var e=this,t=arguments[0];return t(B["a"],[t(A["a"],{class:"chat-room__header"},[t("div",{class:"chat-room__title"},[t("div",[t(b["a"],{on:{click:this.handlePeopleNumberClick}},[t(p["a"],{class:"chat-room__title-badge"},["💬 ",this.people.length])]),this.peoplePopupShowed&&t(G,{attrs:{people:this.people}})]),t("h4",{class:"chat-room__title-text"},[this.room.name])]),t(b["a"],{class:"chat-room__leave-button",attrs:{variant:"yellow"},on:{click:this.handleLeaveClick}},["나가기"])]),t(P["a"],{ref:"chatFrameBody",nativeOn:{scroll:this.handleChatFrameBodyScroll}},[t(v,{ref:"messageList",attrs:{messageList:this.messages},scopedSlots:{default:function(a){var s=a.message;return t(S,{key:s.id,attrs:{message:s,isMyMessage:s.sender.id===e.profile.uid},on:{messageLoaded:e.handleNewMessageLoaded}})}}})]),t(q,{ref:"inputPanel",on:{textSubmitted:this.handleTextSubmitted},attrs:{disabled:!this.room.id},scopedSlots:{menus:function(a){var s=a.focusInput,n=a.disabled;return[t($,{class:"chat-frame-input-panel__menu-item",attrs:{accept:"image/*",disabled:n},on:{selectFile:function(t){return e.handleImageSubmitted(t,s)}}},["사진 올리기"]),t(b["a"],{class:"chat-frame-input-panel__menu-item",attrs:{disabled:n},on:{click:e.handleInvitationMenuClick}},["초대"])]}}})])}}]),a}(l["d"]);Object(c["__decorate"])([Object(l["c"])()],U.prototype,"chatFrameBody",void 0),Object(c["__decorate"])([Object(l["c"])()],U.prototype,"messageList",void 0),Object(c["__decorate"])([Object(l["c"])()],U.prototype,"inputPanel",void 0),Object(c["__decorate"])([Object(u["b"])(H["a"])],U.prototype,"profile",void 0),Object(c["__decorate"])([Object(u["b"])(d["d"])],U.prototype,"room",void 0),Object(c["__decorate"])([Object(u["b"])(d["b"])],U.prototype,"people",void 0),Object(c["__decorate"])([Object(u["b"])(d["a"])],U.prototype,"messages",void 0),Object(c["__decorate"])([Object(u["a"])(D["c"])],U.prototype,"enterRoom",void 0),Object(c["__decorate"])([Object(u["a"])(D["e"])],U.prototype,"leaveRoom",void 0),Object(c["__decorate"])([Object(u["a"])(D["a"])],U.prototype,"dispatchMessage",void 0),Object(c["__decorate"])([Object(u["a"])(D["f"])],U.prototype,"sendInvitation",void 0),Object(c["__decorate"])([Object(u["a"])(J["c"])],U.prototype,"requestDialog",void 0),Object(c["__decorate"])([N["a"]],U.prototype,"handleSendInvitationOk",null),Object(c["__decorate"])([Object(l["e"])("room")],U.prototype,"watchRoom",null),Object(c["__decorate"])([N["a"]],U.prototype,"beforeRouteEnter",null),Object(c["__decorate"])([N["a"]],U.prototype,"beforeRouteUpdate",null),U=Object(c["__decorate"])([l["a"]],U);t["default"]=U}}]);
//# sourceMappingURL=chat-room~21833f8f.4679503e.js.map